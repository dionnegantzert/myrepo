---
title: "Star Wars Composers Analysis"
author: "Dionne Gantzert"
date: "2/22/2021"
output:
  flexdashboard::flex_dashboard:
    storyboard: true
    theme: flatly
---
<style>
body, h1, h2, h3, h4 {
    font-family: "Bookman", serif;
}
.navbar {
  background-color:darkviolet;
}

body {
    color: #333333;
}
a, a:hover {
    color: blue;
}
pre {
    font-size: 10px;
}
</style>

### A long time ago, in a galaxy far, far away...
#### Introduction
For many people, Star Wars has been one of the greatest movie series of all time. And even if you haven’t watched it, you certainly know some of the music it contains. Over the years, the Star Wars franchise expanded into various movies and television series, such as the Mandalorian, Clone Wars and Star Wars Rebels. In this portfolio, a distinction is made between the music of three major Star Wars series. These series are The Star Wars movies, composed by John Williams, the Clone Wars series, composed by Kevin Kiner, and the Mandalorian series, composed by Ludwig Goransson. The corpus exists of three times forty songs, for each of these three composers. I think it would be interesting to look into the differences between their music and to see if it is possible to distinguish between them. 

```{r picture, echo = F, fig.cap = "Fig 1: John Williams, Kevin Kiner and Ludwig Goransson", out.width = '50%', fig.align='center'}
knitr::include_graphics("merged.jpg")
```

I expect that the difference between Goransson and Williams is the most noticeable, because Star Wars is a space opera while the Mandalorian defines itself as a space Western. The differences between Kiner and Williams is more difficult to find, and thus far no one has specifically looked into it. While I was listening to the music myself I found that Kiner’s music felt more powerful and energetic.

The corpus tries to cover every movie or episode, but since a movie contains more music than a single episode it was hard to select the right songs. Therefore, I used 5 songs from every Star Wars movie, except for one. This was to maintain an equally divided song selection between the composers. From the Clone Wars series, 10 songs from every season were selected and for the Mandalorian I selected 5 songs per episode of season 1. The songs were randomly selected to avoid a certain bias. Below you can find an overview of the selection.


| John Williams              | Kevin Kiner        | Ludwig Goransson       |
|----------------------------|--------------------|------------------------|
| 5x The Rise of Sky Walker  | 10x Clone Wars I   | 5x The Mandalorian Ch1 |
| 5x The Last Jedi           | 10x Clone Wars II  | 5x The Mandalorian Ch2 |
| 5x The Force Awakens       | 10x Clone Wars III | 5x The Mandalorian Ch3 |
| 5x The Phantom Menace      | 10x Clone Wars IV  | 5x The Mandalorian Ch4 |
| 5x Revenge of the Sith     |                    | 5x The Mandalorian Ch5 |
| 5x A New Hope              |                    | 5x The Mandalorian Ch6 |
| 5x Attack of the Clones    |                    | 5x The Mandalorian Ch7 |
| 5x The Empire Strikes Back |                    | 5x The Mandalorian Ch8 |



“Duel of the fates” is a very typical Star Wars movie song, the loudness and energy of the song is a recurring theme in the Star Wars movies. For the Mandalorian, “The Mandalorian” is a very typical song because it is one of the most similar songs as compared to the Star Wars movies. 

You can find the exact corpus [here](https://open.spotify.com/playlist/0kojyfPUkAer4jsf4RSzDH?si=ryL0pYpGSxebBUsXJ38I-w).


### Star Wars: Episode IV: A New Graph

#### Comparing the Composers Regarding Acousticness, Instrumentalness, Danceability and Popularity
```{r, echo = FALSE, message = FALSE, fig.align='center'}
# Loading in the libraries
library(tidyverse)
library(spotifyr)
library(plotly)

# My three different data sets
williams <- get_playlist_audio_features(, "2tHo38FRHxerzbD1b8gSFE")
kiner <- get_playlist_audio_features(, "5Yx2gl5bGRaYV6IbS9SRig")
goransson <- get_playlist_audio_features(, "1pCbj5RobyHokjVvlRe9xl")

# Combining the data sets
combined <-
  bind_rows(
    williams %>% mutate(category = "John Williams"),
    kiner %>% mutate(category = "Kevin Kiner"),
    goransson %>% mutate(category = "Ludwig Goransson")
  )

# Plot acousticness vs instrumentalness, by composer

tmpgraph <- combined %>%
 ggplot(                          # Set up the plot.
    aes(
      x = instrumentalness,
      y = acousticness,
      size = track.popularity,
      colour = danceability,
      label = track.name           # Labels will be interactively visible.
    )
  ) +
  geom_point() +                   # Scatter plot.
  geom_rug(size = 0.1) +           # Add 'fringes' to show data distribution.
  facet_wrap(~category) +           # Separate charts per country.
  scale_x_continuous(              # Fine-tune the x axis.
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),        # Use grid-lines for quadrants only.
    minor_breaks = NULL            # Remove 'minor' grid-lines.
  ) +
  scale_y_continuous(              # Fine-tune the y axis in the same way.
    limits = c(0, 1),
    breaks = c(0, 0.50, 1),
    minor_breaks = NULL
  ) +
  scale_colour_viridis_c(          # Use the cividis palette
    option = "A",                  # Qualitative set.
    alpha = 0.8,                   # Include some transparency
    guide = "none"
  ) +
  scale_size_continuous(           # Fine-tune the sizes of each point.
    guide = "none"                 # Remove the legend for size.
  ) +
  theme_light() +                  # Use a simpler theme.
  labs(                            # Make the titles nice.
    x = "Instrumentalness",
    y = "Acousticness"
  ) +
  theme(strip.background = element_rect(fill="#660066"))

ggplotly(tmpgraph)
```


In the visualization above you can see the acousticness and instrumentalness plotted against each other. The color of the dots matches the danceability, with the lighter colors having a higher danceability score. The size of the dots matches the popularity of the track. The bigger the dot, the popular the track is. As you can see in the visualization, the music of John Williams stands out as compared to the other two composers, in three ways. First, Williams uses a lot of instrumental and acoustic music, while the music of Kiner and Goransson varies more in acousticness. All of the three composers have a high instrumentalness score, but the acousticness score varies. Second, William's music has a lower danceability score than Kiner's and Goransson's. William's tracks are darker, indicating lower danceability scores. The last way William stands out as compared to the other two composers is the popularity of the tracks. The size of the dots in Williams graph is the only one with really small dots. 

One result that surprised me in this data set was the popularity of the tracks. The Star Wars movies composed by Williams are a lot older than the Star Wars series composed by Kiner and Goransson. Therefore, it would be logical to think that more people watched the movies and thus listened to the older songs (i.e. the older songs would be more popular). Apparently, my intuition was wrong about this since most of the songs composed by Williams are not popular at all. In the visualization below you can see that Williams got the highest amount of songs with a popularity of zero. Goransson on the other hand, did a great job with the highest popularity scores. It would be very interesting to find out why Goransson's music is more popular, but therefore I need more information than the Spotify API can provide. 


```{r, echo = FALSE, fig.align='center'}

combined %>%
  ggplot(                     # Set up the plot.
    aes(
      x = track.popularity,
      fill = category
    )
  ) +
  scale_fill_manual(values = c("#660066", "#f66d7a", "#f6a97a")) +
  geom_histogram(binwidth = 10, position = "dodge", alpha = 0.7) +
  geom_vline(xintercept = 15.55, linetype = "dashed", color = "#660066", size = 1) +
  geom_vline(xintercept = 30.65, linetype = "dashed", color = "#f6a97a", size = 1) +
  geom_vline(xintercept = 36.75, linetype = "dashed", color = "#f6a97a", size = 1) +
  theme_light() +
  labs(
    x = "Popularity",
    y = "Amount of songs",
    title = "Comparing track popularity"
  ) +
  theme_update(plot.title = element_text(hjust = 0.5)) +
  theme(
    text = element_text(family = "Bookman"),
    title = element_text(color = "gray25"),
    plot.caption = element_text(color = "gray30"),
    plot.subtitle = element_text(size = 12)
  )

```

### Star Wars: Episode VIII: The Last Visualization
#### Kevin Kiner's change of instruments

```{r, echo=FALSE, fig.align='center'}
library(compmus)

test2 <-
  get_tidy_audio_analysis("1fqsyRQVJReNyGNj1xZQX9") %>% 
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)

test2k <- test2 %>%
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) %>%
  compmus_gather_chroma() %>% 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c(option="magma") +
  ggtitle("Kevin Kiner: Trace & Rafa") +
  theme_update(plot.title = element_text(hjust = 0.5)) +
  theme(
    text = element_text(family = "Bookman"),
    title = element_text(color = "gray25"),
    plot.caption = element_text(color = "gray30"),
    plot.subtitle = element_text(size = 12)
  )

plot(test2k)

```

In the visualization above, you can see the chromagram of Kevin Kiner's "Trace & Rafa" from the Clone Wars series. A lot of different chroma values are used. At the start of the track, mostly A#, G# and C are used. Further into the track you can see that this switches, A#, G# and C are used fewer and G and F start to join. Something that stands out is the many different chroma values. At first, the song is very calm, contains high tones and has a slow rhythm. Then, after around 100 seconds, the music starts to become louder, with use of 'heavier' instruments. This change is clearly noticeable in the chromagram. 

I still have to work this out in more detail. I am not quite sure if this chromagram is useful for my analysis. I have to give this page more thought. 
